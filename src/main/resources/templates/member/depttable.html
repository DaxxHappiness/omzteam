<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>멤버 리스트</title>
    <style>
        /* 스타일을 사용하여 두 테이블을 좌우로 배치 */
        .container {
            display: flex;
        }
        .table-container {
            flex: 1;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px; /* 테이블 사이 간격 추가 */
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        /* 테이블 헤더 스타일 */
        .table-header {
            background-color: #333;
            color: #fff;
        }
        /* 셀 배경색 */
        .table-cell {
            background-color: #f9f9f9;
        }
        /* 폰트 스타일 */
        .table-header, .table-cell {
            font-weight: bold;
            font-size: 14px;
        }
        /* 그림자 효과 */
        .table-container {
            box-shadow: 2px 2px 5px #888888;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="table-container1">
        <!-- 첫 번째 테이블 (변경 없음) -->
        <table th:each="dto: ${depts}">
            <tr class="table-header">
                <td onclick="toggleRows(this)">
                <h3>[[${dto.dept}]]</h3>
                </td>
            </tr>
            <tr class="myElement" style="display: none" th:each="mem: ${members}" th:if="${dto.dept_no == mem.dept_no}">
                <td class="table-cell">
                    <a th:href="|javascript:a('${mem.mem_no}')|">-[[${mem.mem_name}]]</a>
                </td>
            </tr>
        </table>
    </div>
    <div class="table-container">
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
    function toggleRows(td) {
        var tr = td.parentElement.nextElementSibling; // 클릭된 td 요소의 부모인 tr을 선택하고 다음 형제 요소인 tr을 가져옵니다.
        while (tr && tr.classList.contains('myElement')) {
            if (tr.style.display === "none") {
                tr.style.display = "table-row"; // tr의 스타일을 'table-row'으로 변경
            } else {
                tr.style.display = "none"; // tr의 스타일을 'none'으로 변경
            }
            tr = tr.nextElementSibling; // 다음 형제 요소로 이동
        }
    }

    function  a(mem_no){
        let obj = {"mem_no" : mem_no};
        $.ajax({
            url: '/member/input?mem_no='+mem_no,
            method: 'get',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function (dto) {
                console.log(dto);//내일 여쭤볼것 <>안에 어떻게 사용하는가
                $(".table-container").html(`
                  <table border="1">
            <tr>
                <td class="table-cell">이름</td> <td class="table-cell">${dto.mem_name}</td><td rowspan='3'><img src="/images/${dto.mem_no}.png" alt="이미지 설명" style="width: 200px; height: 150px;"></td>
            </tr>
            <tr>
                <td class="table-cell">직책</td> <td class="table-cell">${dto.job}</td>
            </tr>
            <tr>
                <td class="table-cell">부서</td> <td class="table-cell">${dto.dept}</td>
            </tr>
            <tr>
                <td class="table-cell">전화번호</td> <td colspan='2' class="table-cell">${dto.phone}</td>
            </tr>
            <tr>
                <td class="table-cell">이메일</td> <td  colspan='2' class="table-cell"><a href="mailto:${dto.email}">${dto.email}</a></td>
            </tr>
            <tr>
                 <td class="table-cell">입사일</td> <td  colspan='2'class="table-cell">${dto.hiredate}</td>
            </tr>
            <tr>
                <td  class="table-cell">생일</td> <td  colspan='2' class="table-cell">${dto.birth}</td>
            </tr>
        </table>
                `)
            },
            error: function(err){
                console.log(err);
            }
        })
    }
</script>

</body>
</html>
